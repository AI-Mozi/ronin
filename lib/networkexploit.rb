require 'parameters'
require 'exceptions/missingparam'

module Ronin
  module NetworkExploit

    include Parameters

    def transmit_tcp
      unless rhost
        raise MissingParam, "Missing '#{param_desc(:rhost)}' parameter", caller
      end

      unless rport
        raise MissingParam, "Missing '#{param_desc(:rport)}' parameter", caller
      end

      TCPSocket.new(rhost,rport) do |socket|
        yield socket if block_given?
      end
    end

    def transmit_udp
      unless rhost
        raise MissingParam, "Missing '#{param_desc(:rhost)}' parameter", caller
      end

      unless rport
        raise MissingParam, "Missing '#{param_desc(:rport)}' parameter", caller
      end

      UDPSocket.new(rhost,rport) do |socket|
	socket.bind(lhost,lport) if lhost && lport

        yield socket if block_given?
      end
    end

  end
end
